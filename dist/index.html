<body style="margin: 0"><canvas id="a"></canvas></body><script>var n=Math.PI,t=2*n,e=Math.cos,a=Math.sin,r=window.addEventListener,i=document.getElementById("a"),o=i.getContext("2d"),l=300,u=1e3/60,c={KeyW:"forward",KeyA:"left",KeyS:"backward",KeyD:"right",KeyQ:"turnLeft",KeyE:"turnRight",ArrowUp:"up",ArrowDown:"down"},f=0,d=0,h=0,w=0,g={x:0,y:0,z:0,focal:.9,angle:n/2,unitX:0,unitZ:-1,normalX:1,normalZ:0},m={forward:!1,left:!1,backward:!1,right:!1,up:!1,down:!1,turnLeft:!1,turnRight:!1},y=u/1e3,s=u/1e3,b=u*t/1e3/2,v=0;function X(n){o.fillStyle=n,o.fillRect(0,0,d,f)}function Z(n,t,e,a){o.fillStyle=a,o.beginPath(),o.moveTo(n[0],n[1]),o.lineTo(t[0],t[1]),o.lineTo(e[0],e[1]),o.closePath(),o.fill()}function z(n,t,e){var a=g.unitX,r=g.unitZ,i=g.normalX,o=g.normalZ,u=n-g.x,c=e-g.z,f=(c*a-u*r)/(o*a-i*r),d=Math.abs(a)>Math.abs(r)?(u-f*i)/a:(c-f*o)/r;return[l*(g.focal*f/d)+w,-l*(g.focal*(t-g.y)/d)+h]}function x(n,t,e){var a=z(n,t+1,e),r=z(n+1,t+1,e),i=z(n+1,t+1,e+1),o=z(n,t+1,e+1),l=z(n,t,e),u=z(n+1,t,e),c=z(n+1,t,e+1),f=z(n,t,e+1);Z(a,r,o,"blue"),Z(i,r,o,"blue"),Z(l,u,f,"blue"),Z(u,f,c,"blue"),Z(a,l,f,"blue"),Z(a,f,o,"blue")}function k(){var n=e(g.angle),t=a(g.angle);g.unitX=n,g.unitZ=-t,g.normalX=t,g.normalZ=n}function p(){X("black"),Z(z(-.5,.7,-3),z(.5,.6,-3),z(0,-.2,-3),"green"),x(0,0,-2),requestAnimationFrame(p)}function K(){v++,m.forward&&(g.x+=g.unitX*y,g.z+=g.unitZ*y),m.backward&&(g.x-=g.unitX*y,g.z-=g.unitZ*y),m.left&&(g.x-=g.normalX*y,g.z-=g.normalZ*y),m.right&&(g.x+=g.normalX*y,g.z+=g.normalZ*y),!m.up||(g.y+=y),!m.down||(g.y-=y),m.turnLeft&&(g.angle+=b,k()),m.turnRight&&(g.angle-=b,k())}r("resize",function(n){var t=n.target;f=t.innerHeight,d=t.innerWidth,o.canvas.height=f,o.canvas.width=d,h=f/2,w=d/2,p()}),r("keydown",function(n){m[c[n.code]]=!0}),r("keyup",function(n){m[c[n.code]]=!1}),window.dispatchEvent(new Event("resize")),setInterval(K,u),requestAnimationFrame(p);</script>