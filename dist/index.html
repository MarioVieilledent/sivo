<body style="margin: 0"><canvas id="a"></canvas></body><script>var e=Math.PI,n=2*e,t=Math.cos,a=Math.sin,r=window.addEventListener,i=document.getElementById("a"),o=i.getContext("2d"),u=300,l=1e3/60,c={KeyW:"forward",KeyA:"left",KeyS:"backward",KeyD:"right",KeyQ:"turnLeft",KeyE:"turnRight",ArrowUp:"up",ArrowDown:"down"},f=0,d=0,h=0,w=0,g={x:0,y:0,z:0,focal:.2,angle:e/2,ux:0,uz:-1,nx:1,nz:0},y={forward:!1,left:!1,backward:!1,right:!1,up:!1,down:!1,turnLeft:!1,turnRight:!1},s=l/1e3,b=l/1e3,v=l*n/1e3,z=0;function x(e){o.fillStyle=e,o.fillRect(0,0,d,f)}function m(e,n,t,a){o.fillStyle=a,o.beginPath(),o.moveTo(e[0],e[1]),o.lineTo(n[0],n[1]),o.lineTo(t[0],t[1]),o.closePath(),o.fill()}function k(e,n,t){var a=g.ux,r=g.uz,i=g.nx,o=g.nz,l=e-g.x,c=t-g.z,f=(c*a-l*r)/(o*a-i*r),d=Math.abs(a)>Math.abs(r)?(l-f*i)/a:(c-f*o)/r;return[u*(g.focal*f/d)+w,-u*(g.focal*(n-g.y)/d)+h]}function p(e,n,t){var a=k(e,n+1,t),r=k(e+1,n+1,t),i=k(e+1,n+1,t+1),o=k(e,n+1,t+1),u=k(e,n,t),l=k(e+1,n,t),c=k(e+1,n,t+1),f=k(e,n,t+1);m(a,r,o,"blue"),m(i,r,o,"blue"),m(u,l,f,"blue"),m(l,f,c,"blue"),m(a,u,f,"blue"),m(a,f,o,"blue")}function K(){var e=t(g.angle),n=a(g.angle);g.ux=e,g.uz=-n,g.nx=n,g.nz=e}function A(){x("black"),m(k(-.5,.7,-3),k(.5,.6,-3),k(0,-.2,-3),"green"),p(0,0,-2),requestAnimationFrame(A)}function E(){z++,!y.forward||(g.z-=s),!y.left||(g.x-=s),!y.backward||(g.z+=s),!y.right||(g.x+=s),!y.up||(g.y+=s),!y.down||(g.y-=s),y.turnLeft&&(g.angle+=v,K()),y.turnRight&&(g.angle-=v,K())}r("resize",function(e){var n=e.target;f=n.innerHeight,d=n.innerWidth,o.canvas.height=f,o.canvas.width=d,h=f/2,w=d/2,A()}),r("keydown",function(e){y[c[e.code]]=!0}),r("keyup",function(e){y[c[e.code]]=!1}),window.dispatchEvent(new Event("resize")),setInterval(E,l),requestAnimationFrame(A);</script>